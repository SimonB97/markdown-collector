<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>URL to Markdown Collector</title>
  <style>
    @font-face {
      font-family: 'Atkinson Hyperlegible';
      src: url('fonts/Atkinson-Hyperlegible-Regular-102.ttf') format('truetype');
      font-weight: normal;
    }
    @font-face {
      font-family: 'Atkinson Hyperlegible';
      src: url('fonts/Atkinson-Hyperlegible-Bold-102.ttf') format('truetype');
      font-weight: bold;
    }
    body {
      font-family: 'Atkinson Hyperlegible', Arial, sans-serif;
      width: 200px;
      padding: 10px;
      background-color: var(--background-color);
      color: var(--text-color);
      position: relative;
    }
    .button-container {
      display: flex;
      justify-content: space-between;
    }
    .button-container button {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      height:100px; /* Adjust as needed */
    }
    .button-icon {
      font-size: 2em;
      margin-bottom: 5px;
    }
    .button-text {
      color: var(--text-color);
      font-size: 0.9em;
      margin-bottom: 2px;
    }
    .shortcut-hint {
      font-size: 0.7em;
      color: var(--text-color-light);
    }
    button {
      flex: 1;
      padding: 8px;
      margin: 5px 2px;
      background-color: var(--button-background);
      color: var(--button-color);
      border: 0px;
      font-family: 'Atkinson Hyperlegible', Arial, sans-serif;
    }
    button:hover {
      background-color: var(--button-hover-background);
    }
    .settings-container {
      text-align: right;
      margin-top: 0px;
      margin-bottom: 0px;
      padding-bottom: 0px;
    }
    .settings-container button {
      background: none;
      border: none;
      cursor: pointer;
      padding: 0;
    }
    .settings-container img {
      width: 24px;
      height: 24px;
    }
    .info-container {
      margin-top: 0px;
      font-size: 14px;
      color: var(--text-color-light);
    }

    /* Light theme */
    @media (prefers-color-scheme: light) {
      :root {
        --background-color: #ffffff;
        --text-color: #000000;
        --text-color-light: #b4b4b4;
        --text-color-highlight: #cfa119;
        --button-background: #f0f0f0;
        --button-hover-background: #e0e0e0;
        --button-color: #ffffff;
        --button-border: #afafaf;
        --accordion-background: #7f7f7f34;
      }
    }

    /* Dark theme */
    @media (prefers-color-scheme: dark) {
      :root {
        --background-color: #121212;
        --text-color: #ffffff;
        --text-color-light: #b4b4b4;
        --text-color-highlight: #e6b41cbd;
        --button-background: #33333388;
        --button-hover-background: #44444485;
        --button-color: #ffffff;
        --button-border: #3a3a3a;
        --accordion-background: #7e7e7e11;
      }
    }

    .settings-container button:hover img {
      filter: brightness(0.8);
    }

    .accordion {
      background-color: var(--accordion-background);
      color: var(--button-color);
      cursor: pointer;
      padding: 5px;
      width: 98%;
      text-align: center;
      border: 0px;
      border-radius: 5px;
      outline: none;
      margin-top: 10px;
    }

    .accordion:hover {
      background-color: var(--button-hover-background);
    }

    .panel {
      padding: 0 8px;
      background-color: var(--background-color);
      max-height: 0;
      overflow: hidden;
    }

    .settings-container {
      text-align: center;
      margin-top: 10px;
    }

    /* Refinement interface specific styles */
    .refinement-button {
      background-color: var(--button-background);
      color: var(--text-color);
      border: 1px solid var(--button-border);
      border-radius: 5px;
      padding: 8px 12px;
      font-family: 'Atkinson Hyperlegible', Arial, sans-serif;
      font-size: 12px;
      cursor: pointer;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      margin: 2px 0;
    }

    .refinement-button:hover {
      background-color: var(--button-hover-background);
      transform: translateY(-1px);
    }

    .refinement-button:active {
      transform: translateY(0);
    }

    .refinement-button:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none !important;
      background-color: var(--button-background);
    }

    /* Success state styling */
    .refinement-button .button-icon:contains("‚úÖ") {
      color: #28a745;
    }

    /* Error state styling */
    .refinement-button .button-icon:contains("‚ùå") {
      color: #dc3545;
    }

    /* Loading state styling */
    .refinement-button .button-icon:contains("‚è≥") {
      animation: pulse 1.5s ease-in-out infinite;
    }

    @keyframes pulse {
      0% { opacity: 1; }
      50% { opacity: 0.5; }
      100% { opacity: 1; }
    }

    .cancel-button {
      background-color: transparent;
      color: var(--text-color);
      border: 1px solid var(--button-border);
    }

    .cancel-button:hover {
      background-color: var(--button-background);
      color: var(--text-color);
    }

    #refinement-prompt:focus {
      border-color: var(--button-border);
      outline: none;
    }

    .shortcut-hint {
      font-size: 11px;
      opacity: 0.7;
      margin-top: 3px;
    }
  </style>
</head>
<body>
  <!-- Normal interface -->
  <div id="normal-interface">
    <div class="button-container">
      <button id="open-markdown">
        <span class="button-icon">&#8599;</span>
        <span class="button-text">Open Collection</span>
        <span class="shortcut-hint">Alt + M</span>
      </button>
      <button id="copy-markdown">
        <span class="button-icon">&#128203;</span>
        <span class="button-text">Copy as Markdown</span>
        <span class="shortcut-hint">Alt + C</span>
      </button>
    </div>
  </div>

  <!-- Refinement interface (hidden by default) -->
  <div id="refinement-interface" style="display: none;">
    <div class="button-container" style="flex-direction: column; gap: 10px; padding: 10px;">
      <div style="text-align: center; margin-bottom: 5px;">
        <h3 style="margin: 0; color: var(--text-color); font-size: 14px; font-weight: normal;">Refine Content</h3>
      </div>
      
      <textarea id="refinement-prompt" placeholder="Enter refinement prompt (e.g., 'summarize', 'make concise')" style="
        width: calc(100% - 16px);
        height: 60px;
        padding: 8px;
        margin-bottom: 8px;
        background-color: var(--button-background);
        color: var(--text-color);
        border: 1px solid var(--button-border);
        border-radius: 5px;
        font-family: 'Atkinson Hyperlegible', Arial, sans-serif;
        font-size: 12px;
        resize: vertical;
        outline: none;
      "></textarea>
      
      <button id="refine-content" class="refinement-button">
        <span class="button-icon">‚ú®</span>
        <span class="button-text">Refine with AI</span>
      </button>
      
      <button id="save-without-refine" class="refinement-button">
        <span class="button-icon">üíæ</span>
        <span class="button-text">Save as-is</span>
      </button>
      
      <button id="cancel-refinement" class="refinement-button cancel-button">
        <span class="button-icon">‚ùå</span>
        <span class="button-text">Cancel</span>
      </button>
      
      <div style="margin-top: 5px; font-size: 10px; color: var(--text-color); opacity: 0.6; text-align: center;">
        Enter to refine ‚Ä¢ Shift+Enter for new line
      </div>
    </div>
  </div>
  
  <button class="accordion">How to use</button>
  <div class="panel">
    <div class="info-container">
      <p>
        <div>
          Press <strong style="color: var(--text-color-highlight);">Copy as Markdown</strong> or use <strong style="color: var(--text-color-highlight);">Alt+C</strong> to save the current page and copy its Markdown to clipboard quickly.<br>
          <hr style="border: 0; height: 1px; background-color: rgba(128, 128, 128, 0.3); margin: 5px 0;">
          Use <strong style="color: var(--text-color-highlight);">Alt+I</strong> to quickly save (insert) a page without copying.<br>
          <hr style="border: 0; height: 1px; background-color: rgba(128, 128, 128, 0.3); margin: 5px 0;">
          Open the Markdown collection page to view and manage your saved URLs (<strong style="color: var(--text-color-highlight);">Alt+M</strong>).
        </div>
      </p>
    </div>
  </div>
  
  <div class="settings-container">
    <button id="open-settings" title="Settings">
      <img src="icons/cogwheel.png" alt="Settings">
    </button>
  </div>
  
  <div id="status-message" style="display: none; margin-top: 10px; text-align: center;"></div>
  <script src="scripts/components/popup.js"></script>
  <script src="scripts/components/accordion.js"></script>
</body>
</html>
